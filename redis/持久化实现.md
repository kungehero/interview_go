# rdb

- 原理
```
保存某时间段之前的数据，分为手动和自动配置触发机制。
save 阻塞进程
bgsave 后台fork子进程 不阻塞进程

配置文件
save 900 1  900秒内有一个改变
```
- 是否阻塞主线程
```
后台触发不阻塞主进程，提高并发性能
```
- 优缺点
```
优点：
- 重启数据恢复时，二进制文件加载快，直接读取到内存，比aof读取效率高
- 性能高，fork子进程完成写操作，主进程处理其他命令，使性能最大化
缺点：
- 安全性不高，断电时出现大段时间时间丢失
- 内存性能损耗，
```
# aof

- 原理
```
以独立日志的方式记录每次写命令， 重启时再重新执行AOF文件中的命令达到恢复数据的目的
```
- 是否阻塞主线程
```
redis是单线程，如果直接追加命令到磁盘，影响性能，利用aof缓冲区写入。
aof追加文件阻塞，使用aof缓存减少阻塞，提高性能
```
- 优缺点
```
优点：
- 安全性能高
- bgwrite 优化重写命令
缺点：
- 重启恢复数据时比rdb慢

```
